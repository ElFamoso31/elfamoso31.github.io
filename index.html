<html>
  <head>
    <title>Projet What's On</title>
    <script type="text/javascript">
      const parserTisseo = (data) => {
        let results = "Aucune donnée disponible";
        if (data) {
          const departs = data.departures.departure;
          results = "<ul>";
          for (let i = 0; i < departs.length; i = i + 1) {
            if (departs[i].dateTime) {
              results +=
                "<li>" +
                departs[i].dateTime
                  .replace(/^\d+-\d+-\d+ /, "")
                  .replace(/:\d\d$/, "") +
                "" +
                departs[i].line.shortName +
                " " +
                departs[i].destination[0].name +
                '<span class="landscape">(' +
                departs[i].destination[0].cityName +
                ")</span>" +
                "</li>";
            }
          }
          if (results == "<ul>") {
            results += "Aucun départ prévu";
          }
          results += "</ul>";
        }
        return results;
      };

      const tram_aeroconstellation = (data) => {
        document.getElementById("resultatstramaero").innerHTML = parserTisseo(
          data
        );
      };

      const tram_palais_de_justice = (data) => {
        document.getElementById("resultatstrampalais").innerHTML = parserTisseo(
          data
        );
      };
    </script>
  </head>
  <body>
    <h1>What's On</h1>
    <h3>Météo à Blagnac</h3>

    <script
      charset="UTF-8"
      src="https://meteofrance.com/mf3-rpc-portlet/rest/vignettepartenaire/310690/type/VILLE_FRANCE/size/PORTRAIT_VIGNETTE"
      type="text/javascript"
    ></script>

    <h3>Tram T1 - Départs direction Aéroconstellation</h3>

    <div id="resultatstramaero"></div>

    <h3>Tram T1 - Départs direction Palais de Justice</h3>

    <h3>Mon agenda à l'IUT de Blagnac</h3>

    <h3>Agenda du groupe 1A</h3>

    <iframe
      src="https://calendar.google.com/calendar/embed?src=5nm3ks2gthqrh8jfr13dqifkvhsk3ka5%40import.calendar.google.com&ctz=Europe%2FParis"
      style="border: 0"
      width="800"
      height="600"
      frameborder="0"
      scrolling="no"
    ></iframe>

    <script src="http://algec.iut-blagnac.fr/jsonpv1.php?callback=tram_aeroconstellation&url=http://api.tisseo.fr/v1/stops_schedules.json?operatorCode=60140"></script>
    <script src="http://algec.iut-blagnac.fr/jsonpv1.php?callback=tram_palais_de_justice&url=http://api.tisseo.fr/v1/stops_schedules.json?operatorCode=60141"></script>
  </body>
</html>
